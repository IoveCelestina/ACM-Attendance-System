# ACM集训队考勤统计系统 - 图形化界面版

## 功能特性

### 🗓️ 灵活的统计方式
- **时间段统计**: 选择开始和结束日期进行连续时间段统计
- **指定日期统计**: 选择特定的几天进行统计，适合节假日或特殊训练日

### ⚙️ 统计规则设置
- 支持多种统计规则（集训队日常管理办法、假期管理办法等）
- 可查看每种规则的详细配置和标准
- 灵活配置灵活时长标准、固定打卡要求等

### 🎯 高级设置
- 查看当前系统配置参数
- 了解各种统计规则的详细说明
- 配置输出格式和列设置

### 📊 实时反馈
- 进度条显示统计进度
- 状态提示和错误信息
- 统计完成后自动显示结果

## 安装要求

### 系统要求
- Python 3.6+
- Windows 10/11 (推荐)
- 支持其他操作系统

### 依赖安装
```bash
pip install -r requirements.txt
```

主要依赖：
- `tkinter` (Python内置，无需安装)
- `tkcalendar` (日期选择器)
- 其他原有模块依赖

## 使用方法

### 1. 启动程序
```bash
python GUI_考勤统计.py
```

### 2. 选择统计方式

#### 时间段统计
- 选择"时间段统计"单选按钮
- 设置开始时间和结束时间
- 系统会自动计算该时间段内的考勤数据

#### 指定日期统计
- 选择"指定日期统计"单选按钮
- 点击"添加日期"选择特定日期
- 可以添加多个日期，系统会统计这些日期的考勤数据

### 3. 配置输出文件
- 点击"选择文件"按钮
- 选择保存位置和文件名
- 支持.xlsx和.xls格式

### 4. 选择统计规则
- 从下拉列表中选择合适的统计规则
- 不同规则适用于不同的训练阶段和假期安排

### 5. 高级设置（可选）
- 点击"高级设置"查看详细配置
- 了解各种统计规则的参数设置
- 查看系统配置信息

### 6. 开始统计
- 点击"开始统计"按钮
- 系统会在后台执行统计任务
- 界面会显示进度和状态信息

## 统计规则说明

### 集训队日常管理办法
- **灵活时长标准**: 正式队员14小时，参赛队员16小时
- **固定打卡**: 每周六，12:00-17:00
- **违规判定**: 灵活时长不足或未完成固定打卡

### 假期管理办法
- **训练天数**: 根据具体假期安排设定
- **训练时间**: 通常为9:00-17:00
- **违规判定**: 未达到训练天数要求

## 输出文件格式

统计结果会保存为Excel文件，包含以下列：
- 工号、姓名、性别、类别等基本信息
- 统计时间段的打卡时长
- 灵活次数、固定次数
- 新增违规次数
- 备注信息
- 累计违规次数（自动计算公式）

## 注意事项

1. **网络连接**: 统计过程需要连接得力e+系统获取打卡数据
2. **文件权限**: 确保有权限读取训练情况文件和写入输出文件
3. **时间设置**: 指定日期统计时，建议选择连续的日期以获得更好的统计效果
4. **规则选择**: 根据实际训练安排选择合适的统计规则

## 故障排除

### 常见问题

1. **tkcalendar导入错误**
   ```bash
   pip install tkcalendar
   ```

2. **统计过程中断**
   - 检查网络连接
   - 确认文件权限
   - 查看控制台错误信息

3. **输出文件无法保存**
   - 检查文件路径是否正确
   - 确认目标目录有写入权限
   - 确保文件没有被其他程序占用

### 技术支持

如遇到问题，请：
1. 查看控制台输出的错误信息
2. 检查系统日志
3. 联系系统管理员

## 更新日志

- **v2.0**: 新增图形化界面
  - 支持时间段和指定日期统计
  - 添加高级设置功能
  - 改进用户体验和错误处理

- **v1.0**: 原始命令行版本
  - 基础统计功能
  - 支持多种统计规则
